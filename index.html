<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>详细订单记录管理系统（4页分页+刷单显隐+币种选项+多维度统计）</title>
    <!-- 引入ECharts CDN，用于渲染统计图 -->
    <script src="https://cdn.bootcdn.net/ajax/libs/echarts/5.4.3/echarts.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "Microsoft YaHei", sans-serif;
        }

        body {
            background-color: #f5f7fa;
            padding: 20px;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            padding: 30px;
        }

        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 2px solid #007bff;
            padding-bottom: 15px;
        }

        /* 4页Tab分页样式 */
        .order-tabs {
            display: flex;
            flex-wrap: wrap;
            margin-bottom: 20px;
            border-bottom: 1px solid #ddd;
        }

        .tab-item {
            padding: 12px 25px;
            background-color: #f8f9fa;
            border: 1px solid #ddd;
            border-bottom: none;
            border-radius: 8px 8px 0 0;
            cursor: pointer;
            margin-right: 5px;
            font-size: 16px;
            color: #555;
            transition: all 0.2s;
        }

        .tab-item.active {
            background-color: #007bff;
            color: #fff;
            border-color: #007bff;
        }

        .tab-item:hover:not(.active) {
            background-color: #e9ecef;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s ease-in-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* 1. 系统设置页：汇率设置样式 */
        .exchange-rate {
            background-color: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 30px;
            overflow-x: auto;
        }

        .exchange-rate h2 {
            font-size: 18px;
            color: #444;
            margin-bottom: 15px;
        }

        .rate-group {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
            min-width: 400px;
        }

        .rate-group label {
            width: 200px;
            color: #555;
            font-weight: 500;
        }

        .rate-group input {
            flex: 1;
            max-width: 200px;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            outline: none;
            font-size: 14px;
        }

        .rate-group input:focus {
            border-color: #007bff;
            box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.2);
        }

        .rate-tip {
            color: #666;
            font-size: 12px;
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px dashed #ddd;
        }

        /* 系统设置页 - 数据统计区域样式 */
        .data-statistics {
            background-color: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 30px;
            overflow-x: auto;
        }

        .data-statistics h2 {
            font-size: 18px;
            color: #444;
            margin-bottom: 15px;
        }

        /* 筛选栏样式 */
        .filter-bar {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px dashed #ddd;
        }

        .filter-group {
            display: flex;
            align-items: center;
        }

        .filter-group label {
            width: 120px;
            color: #555;
            font-weight: 500;
            margin-right: 10px;
        }

        .filter-group select, .filter-group input {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            outline: none;
            font-size: 14px;
        }

        .filter-group select:focus, .filter-group input:focus {
            border-color: #007bff;
            box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.2);
        }

        /* 日期选择组（动态显示） */
        .date-select-group {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .date-select-group .date-item {
            display: none;
        }

        .date-select-group .date-item.active {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        /* 店铺广告花费录入样式（按店铺单独录入） */
        .shop-ad-cost {
            margin-bottom: 20px;
        }

        .shop-ad-cost h3 {
            font-size: 16px;
            color: #444;
            margin-bottom: 10px;
        }

        .ad-cost-list {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 15px;
        }

        .ad-cost-item {
            display: flex;
            align-items: center;
            min-width: 300px;
        }

        .ad-cost-item label {
            width: 150px;
            color: #555;
            font-weight: 500;
        }

        .ad-cost-item input {
            flex: 1;
            max-width: 200px;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            outline: none;
            font-size: 14px;
        }

        .ad-cost-item input:focus {
            border-color: #007bff;
            box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.2);
        }

        /* 图表容器样式 */
        .chart-container {
            width: 100%;
            height: 500px;
            background-color: #fff;
            border-radius: 4px;
            padding: 10px;
            border: 1px solid #ddd;
        }

        /* 2. 商品图片库页：左图右名展示 */
        .image-library {
            background-color: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 30px;
            overflow-x: auto;
        }

        .image-library h2 {
            font-size: 18px;
            color: #444;
            margin-bottom: 15px;
        }

        .upload-area {
            margin-bottom: 20px;
            padding: 15px;
            border: 2px dashed #ddd;
            border-radius: 4px;
            text-align: center;
            cursor: pointer;
            transition: border-color 0.2s;
        }

        .upload-area:hover {
            border-color: #007bff;
        }

        .upload-area input {
            display: none;
        }

        .upload-tip {
            color: #666;
            font-size: 14px;
            margin-top: 10px;
        }

        /* 图片列表 - 左图右名布局 */
        .img-list {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 15px;
        }

        .img-item {
            display: flex;
            align-items: center;
            width: 300px;
            height: 100px;
            position: relative;
            border: 2px solid #ddd;
            border-radius: 4px;
            overflow: hidden;
            cursor: pointer;
            transition: border-color 0.2s;
            background-color: #fff;
        }

        .img-item:hover {
            border-color: #007bff;
        }

        /* 左侧图片 */
        .img-item .img-prev {
            width: 100px;
            height: 100%;
            flex-shrink: 0;
        }

        .img-item .img-prev img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        /* 右侧图片名称/型号 */
        .img-item .img-name {
            flex: 1;
            padding: 0 15px;
            color: #555;
            font-size: 13px;
            line-height: 1.4;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .img-item .del-img {
            position: absolute;
            top: -5px;
            right: -5px;
            width: 20px;
            height: 20px;
            background-color: #dc3545;
            color: #fff;
            border-radius: 50%;
            text-align: center;
            line-height: 20px;
            font-size: 12px;
            cursor: pointer;
            display: none;
            z-index: 10;
        }

        .img-item:hover .del-img {
            display: block;
        }

        /* 3. 订单页通用样式（泰铢/菲律宾） */
        .add-order {
            background-color: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 30px;
            overflow-x: auto;
        }

        .add-order h2 {
            font-size: 18px;
            color: #444;
            margin-bottom: 15px;
        }

        .form-group {
            display: flex;
            align-items: flex-start;
            margin-bottom: 12px;
            min-width: 800px;
        }

        .form-group label {
            width: 160px;
            color: #555;
            font-weight: 500;
            margin-top: 8px;
        }

        .form-group input, .form-group select {
            flex: 1;
            max-width: 400px;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            outline: none;
            font-size: 14px;
        }

        .form-group input:focus, .form-group select:focus {
            border-color: #007bff;
            box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.2);
        }

        .form-group input[readonly] {
            background-color: #f8f9fa;
            cursor: not-allowed;
        }

        /* 是否刷单单选框样式 */
        .brush-radio-group {
            display: flex;
            gap: 20px;
            margin-top: 5px;
        }

        .brush-radio-group label {
            width: auto;
            margin-top: 0;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .brush-radio-group input {
            max-width: none;
            width: 16px;
            height: 16px;
            flex: none;
        }

        /* 币种选择相关样式 */
        .currency-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .currency-input-wrap {
            display: none;
            flex: 1;
        }

        .currency-input-wrap.active {
            display: block;
        }

        /* 店铺相关样式 */
        .shop-operate {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .add-shop-btn {
            padding: 6px 12px;
            background-color: #28a745;
            color: #fff;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
        }

        .add-shop-btn:hover {
            background-color: #218838;
        }

        /* 店铺弹窗样式 */
        .shop-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }

        .shop-modal-content {
            background-color: #fff;
            border-radius: 8px;
            width: 90%;
            max-width: 400px;
            padding: 20px;
        }

        .shop-modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            border-bottom: 1px solid #ddd;
            padding-bottom: 10px;
        }

        .shop-modal-title {
            font-size: 16px;
            color: #333;
            font-weight: 500;
        }

        .close-shop-modal {
            font-size: 20px;
            cursor: pointer;
            color: #666;
        }

        .close-shop-modal:hover {
            color: #dc3545;
        }

        .shop-form-group {
            margin-bottom: 15px;
        }

        .shop-form-group label {
            display: block;
            margin-bottom: 5px;
            color: #555;
            font-weight: 500;
        }

        .shop-form-group input {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            outline: none;
            font-size: 14px;
        }

        .shop-modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 20px;
        }

        /* 订单图片选择区域样式 */
        .img-select-area {
            flex: 1;
            max-width: 400px;
        }

        .select-img-btn {
            padding: 8px 12px;
            background-color: #007bff;
            color: #fff;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            margin-bottom: 10px;
        }

        .select-img-btn:hover {
            background-color: #0069d9;
        }

        .selected-imgs {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .selected-img-item {
            width: 60px;
            height: 60px;
            border: 2px solid #007bff;
            border-radius: 4px;
            overflow: hidden;
            position: relative;
        }

        .selected-img-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .selected-img-item .del-selected {
            position: absolute;
            top: -5px;
            right: -5px;
            width: 16px;
            height: 16px;
            background-color: #dc3545;
            color: #fff;
            border-radius: 50%;
            text-align: center;
            line-height: 16px;
            font-size: 10px;
            cursor: pointer;
        }

        /* 图片选择弹窗样式 */
        .img-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 999;
        }

        .img-modal-content {
            background-color: #fff;
            border-radius: 8px;
            width: 90%;
            max-width: 800px;
            max-height: 80vh;
            overflow-y: auto;
            padding: 20px;
        }

        .img-modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            border-bottom: 1px solid #ddd;
            padding-bottom: 10px;
        }

        .img-modal-title {
            font-size: 16px;
            color: #333;
            font-weight: 500;
        }

        .close-modal {
            font-size: 20px;
            cursor: pointer;
            color: #666;
        }

        .close-modal:hover {
            color: #dc3545;
        }

        .modal-img-list {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
        }

        .modal-img-item {
            width: 100px;
            height: 100px;
            position: relative;
            border: 2px solid #ddd;
            border-radius: 4px;
            overflow: hidden;
            cursor: pointer;
        }

        .modal-img-item.checked {
            border-color: #007bff;
        }

        .modal-img-item.checked::after {
            content: "✓";
            position: absolute;
            bottom: 0;
            right: 0;
            width: 20px;
            height: 20px;
            background-color: #007bff;
            color: #fff;
            text-align: center;
            line-height: 20px;
            font-size: 12px;
            border-radius: 0 0 0 4px;
        }

        .modal-img-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 20px;
            padding-top: 10px;
            border-top: 1px solid #ddd;
        }

        .modal-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }

        .modal-confirm {
            background-color: #007bff;
            color: #fff;
        }

        .modal-cancel {
            background-color: #6c757d;
            color: #fff;
        }

        /* 按钮样式 */
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            margin-top: 10px;
        }

        .btn-primary {
            background-color: #007bff;
            color: #fff;
            margin-right: 10px;
        }

        .btn-primary:hover {
            background-color: #0069d9;
        }

        .btn-reset {
            background-color: #6c757d;
            color: #fff;
        }

        .btn-reset:hover {
            background-color: #5a6268;
        }

        /* 订单列表样式 */
        .order-list {
            margin-top: 20px;
            overflow-x: auto;
        }

        .order-list h2 {
            font-size: 18px;
            color: #444;
            margin-bottom: 15px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            text-align: center;
            min-width: 1600px;
        }

        th, td {
            padding: 10px 8px;
            border: 1px solid #ddd;
            font-size: 13px;
        }

        th {
            background-color: #007bff;
            color: #fff;
            font-weight: 500;
            white-space: nowrap;
        }

        tr:nth-child(even) {
            background-color: #f8f9fa;
        }

        tr:hover {
            background-color: #e9f5ff;
        }

        .no-order {
            color: #999;
            text-align: center;
            padding: 30px;
            font-size: 16px;
        }

        /* 多张图片展示样式 */
        .order-imgs {
            display: flex;
            gap: 5px;
            justify-content: center;
            align-items: center;
        }

        .order-img {
            width: 60px;
            height: 60px;
            object-fit: cover;
            border-radius: 4px;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .order-img:hover {
            transform: scale(2);
            z-index: 99;
        }

        /* 利润颜色区分 */
        .profit-positive {
            color: #28a745;
            font-weight: 500;
        }

        .profit-negative {
            color: #dc3545;
            font-weight: 500;
        }

        /* 订单状态颜色区分 */
        .status-unshipped {
            color: #ffc107;
            font-weight: 500;
        }

        .status-shipped {
            color: #28a745;
            font-weight: 500;
        }

        .status-cancel {
            color: #dc3545;
            font-weight: 500;
        }

        .status-cancel-shipped {
            color: #6f42c1;
            font-weight: 500;
        }

        /* 隐藏元素样式 */
        .hidden {
            display: none !important;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>详细订单记录管理系统（4页分页+刷单显隐+币种选项+多维度统计）</h1>

        <!-- 4页Tab分页切换 -->
        <div class="order-tabs">
            <div class="tab-item active" onclick="switchTab('setting-tab')">1. 系统设置（汇率+统计）</div>
            <div class="tab-item" onclick="switchTab('image-tab')">2. 商品图片库</div>
            <div class="tab-item" onclick="switchTab('thb-tab')">3. 泰铢订单管理</div>
            <div class="tab-item" onclick="switchTab('php-tab')">4. 菲律宾比索订单管理</div>
        </div>

        <!-- 第1页：系统设置（汇率设置 + 数据统计） -->
        <div class="tab-content active" id="setting-tab">
            <div class="exchange-rate">
                <h2>当日汇率设置（兑1人民币）</h2>
                <div class="rate-group">
                    <label for="thbToCny">1 泰铢 = 多少 人民币：</label>
                    <input type="number" id="thbToCny" placeholder="如0.1865" min="0" step="0.0001" value="0.1865" required>
                </div>
                <div class="rate-group">
                    <label for="phpToCny">1 菲律宾比索 = 多少 人民币：</label>
                    <input type="number" id="phpToCny" placeholder="如0.0125" min="0" step="0.0001" value="0.0125" required>
                </div>
                <p class="rate-tip">提示：1. 汇率请填写当日最新值（保留4位小数）；2. 汇率修改后，已保存订单不会同步更新，仅对新填写订单生效；3. 所有币种金额将基于此汇率换算为人民币。</p>
            </div>

            <!-- 数据统计区域 -->
            <div class="data-statistics">
                <h2>订单数据统计（日/周/月/自定义）</h2>

                <!-- 筛选栏 -->
                <div class="filter-bar">
                    <div class="filter-group">
                        <label for="statType">统计维度：</label>
                        <select id="statType" onchange="renderStatisticsChart()">
                            <option value="profitValue">利润数值（¥）</option>
                            <option value="orderCount">订单数量</option>
                            <option value="profitRate">利润率（%）</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label for="statDimension">时间维度：</label>
                        <select id="statDimension" onchange="switchDateSelect(); renderStatisticsChart()">
                            <option value="day">按日</option>
                            <option value="week">按周</option>
                            <option value="month">按月</option>
                            <option value="custom">自定义日期</option>
                        </select>
                    </div>
                    <!-- 动态日期选择组 -->
                    <div class="date-select-group">
                        <!-- 按日 -->
                        <div class="date-item active" id="dayDateItem">
                            <input type="date" id="statDay" onchange="renderStatisticsChart()" value="" max="">
                        </div>
                        <!-- 按周 -->
                        <div class="date-item" id="weekDateItem">
                            <input type="week" id="statWeek" onchange="renderStatisticsChart()" value="" max="">
                        </div>
                        <!-- 按月 -->
                        <div class="date-item" id="monthDateItem">
                            <input type="month" id="statMonth" onchange="renderStatisticsChart()" value="" max="">
                        </div>
                        <!-- 自定义（优化：支持几号到几号，联动限制） -->
                        <div class="date-item" id="customDateItem">
                            <input type="date" id="statStartDate" onchange="syncCustomDate('start'); renderStatisticsChart()" value="" max="">
                            <span>至</span>
                            <input type="date" id="statEndDate" onchange="syncCustomDate('end'); renderStatisticsChart()" value="" max="">
                        </div>
                    </div>
                </div>

                <!-- 店铺广告花费录入（按店铺单独录入） -->
                <div class="shop-ad-cost">
                    <h3>店铺广告花费录入（¥）</h3>
                    <div class="ad-cost-list" id="adCostList">
                        <p style="color: #999;">暂无店铺，请先新增店铺后录入广告花费</p>
                    </div>
                    <button class="btn btn-primary" onclick="saveShopAdCost()">保存广告花费</button>
                </div>

                <!-- 图表容器 -->
                <div class="chart-container" id="statisticsChart"></div>
            </div>
        </div>

        <!-- 第2页：商品图片库（左图右名展示） -->
        <div class="tab-content" id="image-tab">
            <div class="image-library">
                <h2>商品图片库（上传后可重复选择，左图右名）</h2>
                <div class="upload-area" onclick="document.getElementById('imgUpload').click()">
                    <span>点击上传图片</span>
                    <input type="file" id="imgUpload" accept="image/jpg,image/jpeg,image/png,image/gif" multiple>
                    <p class="upload-tip">支持jpg、png、gif格式，可批量上传，上传后将显示图片名称/型号</p>
                </div>
                <div class="img-list" id="imgLibrary"></div>
            </div>

            <!-- 图片选择弹窗（共用） -->
            <div class="img-modal" id="imgModal">
                <div class="img-modal-content">
                    <div class="img-modal-header">
                        <div class="img-modal-title">选择商品图片（可多选）</div>
                        <div class="close-modal" onclick="closeImgModal()">×</div>
                    </div>
                    <div class="modal-img-list" id="modalImgList"></div>
                    <div class="modal-footer">
                        <button class="modal-btn modal-cancel" onclick="closeImgModal()">取消</button>
                        <button class="modal-btn modal-confirm" onclick="confirmSelectImgs()">确认选择</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- 第3页：泰铢订单管理 -->
        <div class="tab-content" id="thb-tab">
            <div class="add-order">
                <h2>新增泰铢订单</h2>
                <!-- 店铺选择 -->
                <div class="form-group">
                    <label for="thbShopSelect">所属店铺：</label>
                    <div class="shop-operate">
                        <select id="thbShopSelect" required>
                            <option value="">请选择店铺</option>
                        </select>
                        <button class="add-shop-btn" onclick="openShopModal()">新增店铺</button>
                    </div>
                </div>
                <!-- 订单状态 -->
                <div class="form-group">
                    <label for="thbOrderStatus">订单状态：</label>
                    <select id="thbOrderStatus" required>
                        <option value="未发货">未发货</option>
                        <option value="已发货">已发货</option>
                        <option value="取消">取消</option>
                        <option value="取消（已发货）">取消（已发货）</option>
                    </select>
                </div>
                <!-- 订单时间 -->
                <div class="form-group">
                    <label for="thbOrderTime">订单时间：</label>
                    <input type="datetime-local" id="thbOrderTime" placeholder="请选择订单时间" required>
                </div>
                <!-- 订单号 -->
                <div class="form-group">
                    <label for="thbOrderNum">订单号：</label>
                    <input type="text" id="thbOrderNum" placeholder="如OD20260204001" required>
                </div>
                <!-- 订单内容 -->
                <div class="form-group">
                    <label for="thbOrderContent">订单内容：</label>
                    <input type="text" id="thbOrderContent" placeholder="请输入订单内容（商品详情等）" required>
                </div>
                <!-- 商品图片 -->
                <div class="form-group">
                    <label>商品图片：</label>
                    <div class="img-select-area">
                        <button class="select-img-btn" onclick="openImgModal()">从图片库选择</button>
                        <div class="selected-imgs" id="thbSelectedImgs"></div>
                    </div>
                </div>
                <!-- 商品价格 -->
                <div class="form-group">
                    <label for="thbGoodsPriceCny">商品价格(人民币)：</label>
                    <input type="number" id="thbGoodsPriceCny" placeholder="请输入商品价格" min="0" step="0.01" required>
                </div>
                <!-- 头程费用 -->
                <div class="form-group">
                    <label for="thbFirstTripFeeCny">商品头程费用(人民币)：</label>
                    <input type="number" id="thbFirstTripFeeCny" placeholder="请输入头程费用" min="0" step="0.01" required>
                </div>
                <!-- 币种选择（固定为泰铢） -->
                <div class="form-group">
                    <label for="thbCurrencySelect">订单币种：</label>
                    <select id="thbCurrencySelect" disabled style="background-color: #f8f9fa;">
                        <option value="thb" selected>泰铢</option>
                    </select>
                </div>
                <!-- 订单金额（泰铢） -->
                <div class="form-group">
                    <label for="thbOrderAmount">订单金额(泰铢)：</label>
                    <input type="number" id="thbOrderAmount" placeholder="请输入订单金额（泰铢）" min="0" step="0.01">
                </div>
                <!-- 订单金额（人民币，自动换算） -->
                <div class="form-group">
                    <label for="thbOrderAmountCny">订单金额(人民币)：</label>
                    <input type="number" id="thbOrderAmountCny" placeholder="自动换算，无需手动填写" readonly>
                </div>
                <!-- 是否刷单（默认否） -->
                <div class="form-group">
                    <label>是否刷单：</label>
                    <div class="brush-radio-group">
                        <label>
                            <input type="radio" name="thbIsBrush" value="no" checked onchange="toggleBrushInput('thb')"> 否
                        </label>
                        <label>
                            <input type="radio" name="thbIsBrush" value="yes" onchange="toggleBrushInput('thb')"> 是
                        </label>
                    </div>
                </div>
                <!-- 刷单+代付（人民币，默认隐藏） -->
                <div class="form-group hidden" id="thbBrushPayGroup">
                    <label for="thbBrushPay">刷单+代付(人民币)：</label>
                    <input type="number" id="thbBrushPay" placeholder="请输入刷单+代付金额" min="0" step="0.01">
                </div>
                <!-- 发货价格 -->
                <div class="form-group">
                    <label for="thbShipPriceCny">发货价格(人民币)：</label>
                    <input type="number" id="thbShipPriceCny" placeholder="请输入发货价格" min="0" step="0.01" required>
                </div>
                <!-- 收入金额（泰铢） -->
                <div class="form-group">
                    <label for="thbIncomeAmount">收入金额(泰铢)：</label>
                    <input type="number" id="thbIncomeAmount" placeholder="请输入收入金额（泰铢）" min="0" step="0.01">
                </div>
                <!-- 收入金额（人民币，自动换算） -->
                <div class="form-group">
                    <label for="thbIncomeAmountCny">收入金额(人民币)：</label>
                    <input type="number" id="thbIncomeAmountCny" placeholder="自动换算，无需手动填写" readonly>
                </div>
                <!-- 利润（人民币，自动计算） -->
                <div class="form-group">
                    <label for="thbProfitCny">利润(人民币)：</label>
                    <input type="number" id="thbProfitCny" placeholder="自动计算，无需手动填写" readonly style="background-color: #f8f9fa; cursor: not-allowed;">
                </div>
                <button class="btn btn-primary" onclick="addThbOrder()">提交订单</button>
                <button class="btn btn-reset" onclick="resetThbForm()">重置表单</button>
            </div>

            <!-- 泰铢订单列表 -->
            <div class="order-list">
                <h2>泰铢订单记录</h2>
                <table id="thbOrderTable">
                    <thead>
                        <tr>
                            <th>订单时间</th>
                            <th>所属店铺</th>
                            <th>订单号</th>
                            <th>订单内容</th>
                            <th>商品图片</th>
                            <th>商品价格(¥)</th>
                            <th>头程费用(¥)</th>
                            <th>订单金额(泰铢)</th>
                            <th>订单金额(¥)</th>
                            <th>刷单+代付(¥)</th>
                            <th>发货价格(¥)</th>
                            <th>收入金额(泰铢)</th>
                            <th>收入金额(¥)</th>
                            <th>利润(¥)</th>
                            <th>订单状态</th>
                        </tr>
                    </thead>
                    <tbody id="thbOrderTbody">
                    </tbody>
                </table>
                <div class="no-order" id="thbNoOrderTip" style="display: none;">暂无泰铢订单记录，快去添加吧！</div>
            </div>
        </div>

        <!-- 第4页：菲律宾比索订单管理 -->
        <div class="tab-content" id="php-tab">
            <div class="add-order">
                <h2>新增菲律宾比索订单</h2>
                <!-- 店铺选择 -->
                <div class="form-group">
                    <label for="phpShopSelect">所属店铺：</label>
                    <div class="shop-operate">
                        <select id="phpShopSelect" required>
                            <option value="">请选择店铺</option>
                        </select>
                        <button class="add-shop-btn" onclick="openShopModal()">新增店铺</button>
                    </div>
                </div>
                <!-- 订单状态 -->
                <div class="form-group">
                    <label for="phpOrderStatus">订单状态：</label>
                    <select id="phpOrderStatus" required>
                        <option value="未发货">未发货</option>
                        <option value="已发货">已发货</option>
                        <option value="取消">取消</option>
                        <option value="取消（已发货）">取消（已发货）</option>
                    </select>
                </div>
                <!-- 订单时间 -->
                <div class="form-group">
                    <label for="phpOrderTime">订单时间：</label>
                    <input type="datetime-local" id="phpOrderTime" placeholder="请选择订单时间" required>
                </div>
                <!-- 订单号 -->
                <div class="form-group">
                    <label for="phpOrderNum">订单号：</label>
                    <input type="text" id="phpOrderNum" placeholder="如OD20260204001" required>
                </div>
                <!-- 订单内容 -->
                <div class="form-group">
                    <label for="phpOrderContent">订单内容：</label>
                    <input type="text" id="phpOrderContent" placeholder="请输入订单内容（商品详情等）" required>
                </div>
                <!-- 商品图片 -->
                <div class="form-group">
                    <label>商品图片：</label>
                    <div class="img-select-area">
                        <button class="select-img-btn" onclick="openImgModal()">从图片库选择</button>
                        <div class="selected-imgs" id="phpSelectedImgs"></div>
                    </div>
                </div>
                <!-- 商品价格 -->
                <div class="form-group">
                    <label for="phpGoodsPriceCny">商品价格(人民币)：</label>
                    <input type="number" id="phpGoodsPriceCny" placeholder="请输入商品价格" min="0" step="0.01" required>
                </div>
                <!-- 头程费用 -->
                <div class="form-group">
                    <label for="phpFirstTripFeeCny">商品头程费用(人民币)：</label>
                    <input type="number" id="phpFirstTripFeeCny" placeholder="请输入头程费用" min="0" step="0.01" required>
                </div>
                <!-- 币种选择（固定为比索） -->
                <div class="form-group">
                    <label for="phpCurrencySelect">订单币种：</label>
                    <select id="phpCurrencySelect" disabled style="background-color: #f8f9fa;">
                        <option value="php" selected>菲律宾比索</option>
                    </select>
                </div>
                <!-- 订单金额（比索） -->
                <div class="form-group">
                    <label for="phpOrderAmount">订单金额(比索)：</label>
                    <input type="number" id="phpOrderAmount" placeholder="请输入订单金额（比索）" min="0" step="0.01">
                </div>
                <!-- 订单金额（人民币，自动换算） -->
                <div class="form-group">
                    <label for="phpOrderAmountCny">订单金额(人民币)：</label>
                    <input type="number" id="phpOrderAmountCny" placeholder="自动换算，无需手动填写" readonly>
                </div>
                <!-- 是否刷单（默认否） -->
                <div class="form-group">
                    <label>是否刷单：</label>
                    <div class="brush-radio-group">
                        <label>
                            <input type="radio" name="phpIsBrush" value="no" checked onchange="toggleBrushInput('php')"> 否
                        </label>
                        <label>
                            <input type="radio" name="phpIsBrush" value="yes" onchange="toggleBrushInput('php')"> 是
                        </label>
                    </div>
                </div>
                <!-- 刷单+代付（人民币，默认隐藏） -->
                <div class="form-group hidden" id="phpBrushPayGroup">
                    <label for="phpBrushPay">刷单+代付(人民币)：</label>
                    <input type="number" id="phpBrushPay" placeholder="请输入刷单+代付金额" min="0" step="0.01">
                </div>
                <!-- 发货价格 -->
                <div class="form-group">
                    <label for="phpShipPriceCny">发货价格(人民币)：</label>
                    <input type="number" id="phpShipPriceCny" placeholder="请输入发货价格" min="0" step="0.01" required>
                </div>
                <!-- 收入金额（比索） -->
                <div class="form-group">
                    <label for="phpIncomeAmount">收入金额(比索)：</label>
                    <input type="number" id="phpIncomeAmount" placeholder="请输入收入金额（比索）" min="0" step="0.01">
                </div>
                <!-- 收入金额（人民币，自动换算） -->
                <div class="form-group">
                    <label for="phpIncomeAmountCny">收入金额(人民币)：</label>
                    <input type="number" id="phpIncomeAmountCny" placeholder="自动换算，无需手动填写" readonly>
                </div>
                <!-- 利润（人民币，自动计算） -->
                <div class="form-group">
                    <label for="phpProfitCny">利润(人民币)：</label>
                    <input type="number" id="phpProfitCny" placeholder="自动计算，无需手动填写" readonly style="background-color: #f8f9fa; cursor: not-allowed;">
                </div>
                <button class="btn btn-primary" onclick="addPhpOrder()">提交订单</button>
                <button class="btn btn-reset" onclick="resetPhpForm()">重置表单</button>
            </div>

            <!-- 菲律宾比索订单列表 -->
            <div class="order-list">
                <h2>菲律宾比索订单记录</h2>
                <table id="phpOrderTable">
                    <thead>
                        <tr>
                            <th>订单时间</th>
                            <th>所属店铺</th>
                            <th>订单号</th>
                            <th>订单内容</th>
                            <th>商品图片</th>
                            <th>商品价格(¥)</th>
                            <th>头程费用(¥)</th>
                            <th>订单金额(比索)</th>
                            <th>订单金额(¥)</th>
                            <th>刷单+代付(¥)</th>
                            <th>发货价格(¥)</th>
                            <th>收入金额(比索)</th>
                            <th>收入金额(¥)</th>
                            <th>利润(¥)</th>
                            <th>订单状态</th>
                        </tr>
                    </thead>
                    <tbody id="phpOrderTbody">
                    </tbody>
                </table>
                <div class="no-order" id="phpNoOrderTip" style="display: none;">暂无菲律宾比索订单记录，快去添加吧！</div>
            </div>
        </div>
    </div>

    <!-- 店铺新增弹窗 -->
    <div class="shop-modal" id="shopModal">
        <div class="shop-modal-content">
            <div class="shop-modal-header">
                <div class="shop-modal-title">新增店铺</div>
                <div class="close-shop-modal" onclick="closeShopModal()">×</div>
            </div>
            <div class="shop-form-group">
                <label for="shopName">店铺名称：</label>
                <input type="text" id="shopName" placeholder="请输入店铺名称（如XX海外店）" required>
            </div>
            <div class="shop-modal-footer">
                <button class="modal-btn modal-cancel" onclick="closeShopModal()">取消</button>
                <button class="modal-btn modal-confirm" onclick="saveShop()">确认新增</button>
            </div>
        </div>
    </div>

    <script>
        // 全局变量
        let selectedImgBase64 = [];
        let activeTab = "setting-tab";
        let myChart = null; // 统计图实例

        // 页面加载完成初始化
        window.onload = function() {
            renderShopSelect();
            renderImageLibrary();
            renderThbOrderList();
            renderPhpOrderList();
            bindCurrencyCalculate();
            bindImgUpload();
            // 初始化刷单输入框隐藏状态
            toggleBrushInput('thb');
            toggleBrushInput('php');
            // 初始化统计日期为今日
            const today = new Date().toISOString().split("T")[0];
            document.getElementById("statDay").value = today;
            document.getElementById("statStartDate").value = today;
            document.getElementById("statEndDate").value = today;
            // 设置所有日期输入框的最大可选日期为今日
            document.getElementById("statDay").max = today;
            document.getElementById("statWeek").max = today;
            document.getElementById("statMonth").max = today;
            document.getElementById("statStartDate").max = today;
            document.getElementById("statEndDate").max = today;
            // 初始化自定义日期的联动限制
            syncCustomDate("start");
            // 初始化店铺广告花费录入（按店铺单独）
            renderShopAdCost();
            // 初始化统计图（初始清零）
            initStatisticsChart();
            renderStatisticsChart();
        };

        // 1. Tab切换函数（4页适配）
        function switchTab(tabId) {
            document.querySelectorAll(".tab-item").forEach(item => item.classList.remove("active"));
            document.querySelectorAll(".tab-content").forEach(content => content.classList.remove("active"));
            document.querySelector(`[onclick="switchTab('${tabId}')"]`).classList.add("active");
            document.getElementById(tabId).classList.add("active");
            activeTab = tabId;
            // 切换到设置页时，重新渲染统计图（防止容器大小异常）
            if (tabId === "setting-tab") {
                renderStatisticsChart();
            }
        }

        // 切换日期选择控件显示
        function switchDateSelect() {
            const dimension = document.getElementById("statDimension").value;
            // 隐藏所有日期项
            document.querySelectorAll(".date-item").forEach(item => item.classList.remove("active"));
            // 显示对应维度的日期项
            document.getElementById(`${dimension}DateItem`).classList.add("active");
        }

        // 自定义日期联动（开始日期≤结束日期，且不超过今日）
        function syncCustomDate(type) {
            const today = new Date().toISOString().split("T")[0];
            const startDateInput = document.getElementById("statStartDate");
            const endDateInput = document.getElementById("statEndDate");
            
            // 统一设置最大日期为今日，禁止选择未来日期
            startDateInput.max = today;
            endDateInput.max = today;

            if (type === "start") {
                // 开始日期变更后，结束日期的最小日期设为开始日期
                endDateInput.min = startDateInput.value;
                // 若结束日期小于开始日期，同步更新结束日期为开始日期
                if (endDateInput.value && endDateInput.value < startDateInput.value) {
                    endDateInput.value = startDateInput.value;
                }
            } else {
                // 结束日期变更后，开始日期的最大日期设为结束日期
                startDateInput.max = endDateInput.value;
                // 若开始日期大于结束日期，同步更新开始日期为结束日期
                if (startDateInput.value && startDateInput.value > endDateInput.value) {
                    startDateInput.value = endDateInput.value;
                }
            }
        }

        // 自定义日期合法性校验
        function checkCustomDateValid() {
            const startDate = document.getElementById("statStartDate").value;
            const endDate = document.getElementById("statEndDate").value;
            
            // 判断是否填写完整
            if (!startDate || !endDate) {
                alert("自定义日期请完整选择「起始日期」和「结束日期」！");
                return false;
            }
            
            // 判断起始日期是否晚于结束日期（兜底校验，防止特殊情况绕过联动）
            if (new Date(startDate) > new Date(endDate)) {
                alert("自定义日期的「起始日期」不能晚于「结束日期」！");
                return false;
            }
            
            return true;
        }

        // 2. 店铺相关函数
        function openShopModal() {
            document.getElementById("shopModal").style.display = "flex";
            document.getElementById("shopName").value = "";
        }

        function closeShopModal() {
            document.getElementById("shopModal").style.display = "none";
        }

        function saveShop() {
            const shopName = document.getElementById("shopName").value.trim();
            if (!shopName) {
                alert("店铺名称不能为空！");
                return;
            }

            let shopList = JSON.parse(localStorage.getItem("shopList")) || [];
            if (shopList.some(shop => shop === shopName)) {
                alert("该店铺已存在，无需重复新增！");
                closeShopModal();
                return;
            }

            shopList.push(shopName);
            localStorage.setItem("shopList", JSON.stringify(shopList));
            renderShopSelect();
            // 新增店铺后，重新渲染广告花费录入（按店铺单独）
            renderShopAdCost();
            closeShopModal();
            alert("店铺新增成功！");
        }

        function renderShopSelect() {
            const thbShopSelect = document.getElementById("thbShopSelect");
            const phpShopSelect = document.getElementById("phpShopSelect");
            let shopList = JSON.parse(localStorage.getItem("shopList")) || [];

            // 同步渲染两个订单页的店铺选择框
            const shopSelectHtml = "<option value=''>请选择店铺</option>" + shopList.map(shop => {
                return `<option value="${shop}">${shop}</option>`;
            }).join("");

            thbShopSelect.innerHTML = shopSelectHtml;
            phpShopSelect.innerHTML = shopSelectHtml;
        }

        // 渲染店铺广告花费录入（按店铺单独）
        function renderShopAdCost() {
            const adCostList = document.getElementById("adCostList");
            let shopList = JSON.parse(localStorage.getItem("shopList")) || [];
            let shopAdCost = JSON.parse(localStorage.getItem("shopAdCost")) || {};

            if (shopList.length === 0) {
                adCostList.innerHTML = "<p style='color: #999;'>暂无店铺，请先新增店铺后录入广告花费</p>";
                return;
            }

            adCostList.innerHTML = "";
            shopList.forEach(shop => {
                const adCostItem = document.createElement("div");
                adCostItem.className = "ad-cost-item";
                adCostItem.innerHTML = `
                    <label for="adCost_${shop}">${shop}：</label>
                    <input type="number" id="adCost_${shop}" placeholder="请输入广告花费" min="0" step="0.01" value="${shopAdCost[shop] || 0}">
                `;
                adCostList.appendChild(adCostItem);
            });
        }

        // 保存店铺广告花费（按店铺单独保存）
        function saveShopAdCost() {
            let shopList = JSON.parse(localStorage.getItem("shopList")) || [];
            if (shopList.length === 0) {
                alert("暂无店铺，无法录入广告花费！");
                return;
            }

            let shopAdCost = {};
            shopList.forEach(shop => {
                const adCostValue = document.getElementById(`adCost_${shop}`).value || 0;
                shopAdCost[shop] = parseFloat(adCostValue).toFixed(2);
            });

            localStorage.setItem("shopAdCost", JSON.stringify(shopAdCost));
            alert("店铺广告花费保存成功！");
        }

        // 3. 图片相关函数（左图右名展示）
        function bindImgUpload() {
            const imgUpload = document.getElementById("imgUpload");
            imgUpload.addEventListener("change", function(e) {
                const files = e.target.files;
                if (!files.length) return;

                for (let i = 0; i < files.length; i++) {
                    const file = files[i];
                    const reader = new FileReader();

                    reader.onload = function(event) {
                        const imgBase64 = event.target.result;
                        const imgName = file.name;

                        let imageLibrary = JSON.parse(localStorage.getItem("imageLibrary")) || [];
                        const isDuplicate = imageLibrary.some(img => img.base64.substring(0, 100) === imgBase64.substring(0, 100));
                        if (isDuplicate) return;

                        imageLibrary.push({
                            name: imgName,
                            base64: imgBase64
                        });

                        localStorage.setItem("imageLibrary", JSON.stringify(imageLibrary));
                        renderImageLibrary();
                    };

                    reader.readAsDataURL(file);
                }

                imgUpload.value = "";
            });
        }

        function renderImageLibrary() {
            const imgLibrary = document.getElementById("imgLibrary");
            let imageLibrary = JSON.parse(localStorage.getItem("imageLibrary")) || [];

            imgLibrary.innerHTML = "";

            if (imageLibrary.length === 0) {
                imgLibrary.innerHTML = "<p style='color: #999;'>暂无上传图片，快去上传吧！</p>";
                return;
            }

            // 左图右名布局渲染
            imageLibrary.forEach((img, index) => {
                const imgItem = document.createElement("div");
                imgItem.className = "img-item";
                imgItem.innerHTML = `
                    <div class="img-prev">
                        <img src="${img.base64}" alt="${img.name}">
                    </div>
                    <div class="img-name" title="${img.name}">${img.name}</div>
                    <div class="del-img" onclick="deleteImgFromLibrary(${index})">×</div>
                `;
                imgLibrary.appendChild(imgItem);
            });
        }

        function deleteImgFromLibrary(index) {
            if (!confirm("确定要删除这张图片吗？删除后无法恢复！")) return;

            let imageLibrary = JSON.parse(localStorage.getItem("imageLibrary")) || [];
            imageLibrary.splice(index, 1);
            localStorage.setItem("imageLibrary", JSON.stringify(imageLibrary));
            renderImageLibrary();
        }

        function openImgModal() {
            const imgModal = document.getElementById("imgModal");
            const modalImgList = document.getElementById("modalImgList");
            let imageLibrary = JSON.parse(localStorage.getItem("imageLibrary")) || [];

            modalImgList.innerHTML = "";

            if (imageLibrary.length === 0) {
                modalImgList.innerHTML = "<p style='color: #999; text-align: center;'>暂无图片可选，请先上传！</p>";
                imgModal.style.display = "flex";
                return;
            }

            imageLibrary.forEach((img, index) => {
                const modalImgItem = document.createElement("div");
                modalImgItem.className = "modal-img-item";
                modalImgItem.dataset.index = index;
                modalImgItem.dataset.base64 = img.base64;
                modalImgItem.innerHTML = `<img src="${img.base64}" alt="${img.name}">`;

                modalImgItem.addEventListener("click", function() {
                    this.classList.toggle("checked");
                });

                modalImgList.appendChild(modalImgItem);
            });

            imgModal.style.display = "flex";
        }

        function closeImgModal() {
            const imgModal = document.getElementById("imgModal");
            imgModal.style.display = "none";
            document.querySelectorAll(".modal-img-item").forEach(item => item.classList.remove("checked"));
        }

        function confirmSelectImgs() {
            const checkedImgItems = document.querySelectorAll(".modal-img-item.checked");
            selectedImgBase64 = [];

            // 根据当前激活Tab，渲染对应订单页的选中图片
            const selectedImgsDom = activeTab === "thb-tab" 
                ? document.getElementById("thbSelectedImgs") 
                : document.getElementById("phpSelectedImgs");
            
            selectedImgsDom.innerHTML = "";

            if (!checkedImgItems.length) {
                closeImgModal();
                return;
            }

            checkedImgItems.forEach(item => {
                const imgBase64 = item.dataset.base64;
                selectedImgBase64.push(imgBase64);

                const selectedImgItem = document.createElement("div");
                selectedImgItem.className = "selected-img-item";
                selectedImgItem.innerHTML = `
                    <img src="${imgBase64}" alt="已选择图片">
                    <div class="del-selected" onclick="deleteSelectedImg(this, '${imgBase64}')">×</div>
                `;
                selectedImgsDom.appendChild(selectedImgItem);
            });

            closeImgModal();
        }

        function deleteSelectedImg(el, imgBase64) {
            selectedImgBase64 = selectedImgBase64.filter(base64 => base64 !== imgBase64);
            el.parentElement.remove();
        }

        // 4. 币种换算相关函数
        function bindCurrencyCalculate() {
            // 泰铢相关输入框
            const thbToCny = document.getElementById("thbToCny");
            const thbOrderAmount = document.getElementById("thbOrderAmount");
            const thbIncomeAmount = document.getElementById("thbIncomeAmount");

            // 比索相关输入框
            const phpToCny = document.getElementById("phpToCny");
            const phpOrderAmount = document.getElementById("phpOrderAmount");
            const phpIncomeAmount = document.getElementById("phpIncomeAmount");

            // 绑定泰铢换算事件
            [thbToCny, thbOrderAmount, thbIncomeAmount].forEach(field => {
                field.addEventListener("input", function() {
                    calculateThbOrderCny();
                    calculateThbIncomeCny();
                    calculateThbProfit();
                });
            });

            // 绑定比索换算事件
            [phpToCny, phpOrderAmount, phpIncomeAmount].forEach(field => {
                field.addEventListener("input", function() {
                    calculatePhpOrderCny();
                    calculatePhpIncomeCny();
                    calculatePhpProfit();
                });
            });

            // 绑定利润相关输入框事件
            // 泰铢
            [document.getElementById("thbGoodsPriceCny"), document.getElementById("thbFirstTripFeeCny"),
             document.getElementById("thbBrushPay"), document.getElementById("thbShipPriceCny")].forEach(field => {
                field.addEventListener("input", () => calculateThbProfit());
            });

            // 比索
            [document.getElementById("phpGoodsPriceCny"), document.getElementById("phpFirstTripFeeCny"),
             document.getElementById("phpBrushPay"), document.getElementById("phpShipPriceCny")].forEach(field => {
                field.addEventListener("input", () => calculatePhpProfit());
            });
        }

        // 泰铢换算
        function calculateThbOrderCny() {
            const thbToCny = parseFloat(document.getElementById("thbToCny").value) || 0;
            const thbOrderAmount = parseFloat(document.getElementById("thbOrderAmount").value) || 0;
            const orderCny = thbOrderAmount * thbToCny;
            document.getElementById("thbOrderAmountCny").value = orderCny.toFixed(2);
            return orderCny;
        }

        function calculateThbIncomeCny() {
            const thbToCny = parseFloat(document.getElementById("thbToCny").value) || 0;
            const thbIncomeAmount = parseFloat(document.getElementById("thbIncomeAmount").value) || 0;
            const incomeCny = thbIncomeAmount * thbToCny;
            document.getElementById("thbIncomeAmountCny").value = incomeCny.toFixed(2);
            return incomeCny;
        }

        // 比索换算
        function calculatePhpOrderCny() {
            const phpToCny = parseFloat(document.getElementById("phpToCny").value) || 0;
            const phpOrderAmount = parseFloat(document.getElementById("phpOrderAmount").value) || 0;
            const orderCny = phpOrderAmount * phpToCny;
            document.getElementById("phpOrderAmountCny").value = orderCny.toFixed(2);
            return orderCny;
        }

        function calculatePhpIncomeCny() {
            const phpToCny = parseFloat(document.getElementById("phpToCny").value) || 0;
            const phpIncomeAmount = parseFloat(document.getElementById("phpIncomeAmount").value) || 0;
            const incomeCny = phpIncomeAmount * phpToCny;
            document.getElementById("phpIncomeAmountCny").value = incomeCny.toFixed(2);
            return incomeCny;
        }

        // 5. 是否刷单显隐控制
        function toggleBrushInput(prefix) {
            const isBrushYes = document.querySelector(`input[name="${prefix}IsBrush"][value="yes"]`).checked;
            const brushPayGroup = document.getElementById(`${prefix}BrushPayGroup`);

            if (isBrushYes) {
                brushPayGroup.classList.remove("hidden");
                // 选择"是"时，刷单输入框变为必填
                document.getElementById(`${prefix}BrushPay`).required = true;
            } else {
                brushPayGroup.classList.add("hidden");
                // 选择"否"时，刷单输入框变为非必填，值清空
                const brushPayInput = document.getElementById(`${prefix}BrushPay`);
                brushPayInput.required = false;
                brushPayInput.value = "";
                // 重新计算利润
                if (prefix === "thb") calculateThbProfit();
                else calculatePhpProfit();
            }
        }

        // 6. 利润计算（取消订单扣减额外利润）
        function calculateThbProfit() {
            const incomeCny = calculateThbIncomeCny();
            const goodsPrice = parseFloat(document.getElementById("thbGoodsPriceCny").value) || 0;
            const firstTripFee = parseFloat(document.getElementById("thbFirstTripFeeCny").value) || 0;
            const brushPay = parseFloat(document.getElementById("thbBrushPay").value) || 0;
            const shipPrice = parseFloat(document.getElementById("thbShipPriceCny").value) || 0;
            const orderStatus = document.getElementById("thbOrderStatus").value;

            // 取消订单额外扣减（扣减商品价格的50%，可调整）
            const cancelDeduct = (orderStatus === "取消" || orderStatus === "取消（已发货）") ? (goodsPrice * 0.5) : 0;

            const profit = incomeCny - goodsPrice - firstTripFee - brushPay - shipPrice - cancelDeduct;
            document.getElementById("thbProfitCny").value = profit.to
